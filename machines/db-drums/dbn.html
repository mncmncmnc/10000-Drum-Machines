<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>De Bruijn Drum Machine</title>
  <link rel="stylesheet" href="dbn.css" />
</head>
<body>
  <button id="infoButton" class="corner-button">?</button>
  <a class="corner-button" href="/" id="backButton">←</a>

  <div class="drum-machine">
    <div class="controls">
      <button id="playPause">Play</button>
      <div class="bpm-control">
        <label for="bpm">BPM:</label>
        <input type="range" id="bpm" min="30" max="300" value="120" />
        <span id="decimalBpm">(120)</span>
      </div>
    </div>
    <div class="tracks"></div>
  </div>

  <div id="infoModal" class="modal">
    <div class="modal-content">
      <span class="close-button" id="closeModal">&times;</span>
      <div class="modal-body">
        <p><strong>About this drum machine:</strong></p>
        <p>This sequencer uses a mathematical structure called a <strong>De Bruijn sequence</strong> to generate rhythm patterns. A De Bruijn sequence is a cyclic string that contains every possible binary combination of a given length exactly once. In this case, we're using every possible 8-bit pattern.</p>
        <p>Each track is controlled by a number from 0–255, which selects an offset into the 256-bit De Bruijn sequence. The next 8 bits at that point determine whether the sound is triggered at each of 8 steps in the loop. This allows every possible rhythmic pattern to be accessed with a single number.</p>
        <p>I think of this De Bruijn method as the opposite of the Godfried Toussaint Euclidean drum algorithm. While Euclidean drums are funky and natural and authentic sounding, De Bruijn sequences are uncomfortable and robotic sounding</p> 
        <p>Try dragging the sliders, or hitting "RND" for a random number.</p>
        <p>Sounds are generated by the python script in the repo. This machine is by <a href="https://www.musicthing.co.uk/">Tom Whitwell / Music Thing Modular</a> and is part of the <a href="/">10,000 Drum Machines</a> series by <a href="https://maxy.world/" target="_blank">Maxwell Neely-Cohen</a>.</p>
      </div>
    </div>
  </div>

  <script src="dbn.js"></script>
  <script>
    const infoModal = document.getElementById('infoModal');
    document.getElementById('infoButton').onclick = () => infoModal.style.display = 'block';
    document.getElementById('closeModal').onclick = () => infoModal.style.display = 'none';
    window.onclick = e => { if (e.target === infoModal) infoModal.style.display = 'none'; };
  </script>
</body>
</html>
